<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Printing maps with dawaR and ggplot2 • dawaR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Printing maps with dawaR and ggplot2">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dawaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/dawaR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/printing_maps.html">Printing maps with dawaR and ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/status.html">Checking the API status</a></li>
    <li><a class="dropdown-item" href="../articles/renv-issues.html">Issues with `{sf}` when installing with `{renv}`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aleksanderbl29/dawaR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Printing maps with dawaR and ggplot2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/aleksanderbl29/dawaR/blob/main/vignettes/articles/printing_maps.Rmd" class="external-link"><code>vignettes/articles/printing_maps.Rmd</code></a></small>
      <div class="d-none name"><code>printing_maps.Rmd</code></div>
    </div>

    
    
<p>This article will show you how to use <code><a href="../reference/get_map_data.html">get_map_data()</a></code> and
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> to draw nice looking maps of Denmark.</p>
<p>First we need to load the packages. Here, we only load
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> to minimize dependencies, but you can definitely
load the entire <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> for convenience.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dawar.aleksanderbl.dk/">dawaR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.5.1</span></span></code></pre></div>
<div class="section level2">
<h2 id="getting-map-data">Getting map data<a class="anchor" aria-label="anchor" href="#getting-map-data"></a>
</h2>
<p>After loading the required packages we need to get the map data. We
will request map data for all (98) danish municipalities. The danish
word for <em>municipality</em> is <em>kommune</em> which is what we will
request.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">municipalities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_map_data.html">get_map_data</a></span><span class="op">(</span><span class="st">"kommuner"</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Getting data on `kommuner`. This usually takes 13.13s.</span></span>
<span><span class="co">#&gt; Fetching data from the API. This will take some time.</span></span>
<span><span class="co">#&gt; Reading data to `st`.</span></span>
<span><span class="co">#&gt; Converting map data to `sf` object</span></span></code></pre></div>
<p>In the dropdown below you can see the <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code> of the data
we have received.</p>
<details><summary><code>head(municipalities)</code>
</summary><pre><code><span>  <span class="co">#&gt; Simple feature collection with 6 features and 11 fields</span></span>
<span>  <span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span>  <span class="co">#&gt; Dimension:     XY</span></span>
<span>  <span class="co">#&gt; Bounding box:  xmin: 12.2635 ymin: 55.53633 xmax: 12.73425 ymax: 55.77944</span></span>
<span>  <span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span>  <span class="co">#&gt;   dagi_id kode          navn regionskode udenforkommuneinddeling</span></span>
<span>  <span class="co">#&gt; 1  389103 0101     København        1084                   FALSE</span></span>
<span>  <span class="co">#&gt; 2  389104 0147 Frederiksberg        1084                   FALSE</span></span>
<span>  <span class="co">#&gt; 3  389105 0151      Ballerup        1084                   FALSE</span></span>
<span>  <span class="co">#&gt; 4  389106 0153       Brøndby        1084                   FALSE</span></span>
<span>  <span class="co">#&gt; 5  389107 0155        Dragør        1084                   FALSE</span></span>
<span>  <span class="co">#&gt; 6  389108 0157      Gentofte        1084                   FALSE</span></span>
<span>  <span class="co">#&gt;          regionsnavn              ændret          geo_ændret geo_version</span></span>
<span>  <span class="co">#&gt; 1 Region Hovedstaden 2024-10-04 21:02:54 2024-10-04 21:02:54          21</span></span>
<span>  <span class="co">#&gt; 2 Region Hovedstaden 2024-01-16 22:03:35 2024-01-16 22:03:35           7</span></span>
<span>  <span class="co">#&gt; 3 Region Hovedstaden 2025-05-14 21:02:41 2025-05-14 21:02:41           9</span></span>
<span>  <span class="co">#&gt; 4 Region Hovedstaden 2024-01-10 22:10:55 2024-01-10 22:10:55           7</span></span>
<span>  <span class="co">#&gt; 5 Region Hovedstaden 2023-03-24 22:28:38 2023-03-24 22:28:38           3</span></span>
<span>  <span class="co">#&gt; 6 Region Hovedstaden 2024-10-04 21:02:54 2024-10-04 21:02:54           7</span></span>
<span>  <span class="co">#&gt;   visueltcenter_x visueltcenter_y                       geometry</span></span>
<span>  <span class="co">#&gt; 1        12.49391        55.70409 MULTIPOLYGON (((12.56767 55...</span></span>
<span>  <span class="co">#&gt; 2        12.52373        55.67937 MULTIPOLYGON (((12.53735 55...</span></span>
<span>  <span class="co">#&gt; 3        12.36852        55.72707 MULTIPOLYGON (((12.30407 55...</span></span>
<span>  <span class="co">#&gt; 4        12.40438        55.64504 MULTIPOLYGON (((12.44279 55...</span></span>
<span>  <span class="co">#&gt; 5        12.65023        55.59381 MULTIPOLYGON (((12.64513 55...</span></span>
<span>  <span class="co">#&gt; 6        12.55072        55.75098 MULTIPOLYGON (((12.59175 55...</span></span></code></pre>
</details><p>The data can then be passed to a <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf()</a></code> to
print the map. I have also specified that the fill color should be based
on the municipality name to make it a bit more colorful.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">municipalities</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">navn</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_map.html" class="external-link">theme_map</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="printing_maps_files/figure-html/print_map_municipality-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="drawing-maps-with-many-lines">Drawing maps with many lines<a class="anchor" aria-label="anchor" href="#drawing-maps-with-many-lines"></a>
</h2>
<p>The above example is not very resource intensive. Trying to plot all
the danish voting precincts on the other hand, is somewhat more
intensive. To ease the production of such maps, I will now demonstrate
how easy it is to simplify the lines (without loss of substantial
quality) to faster plot the map. We will use the
<code><a href="https://rdrr.io/pkg/rmapshaper/man/ms_simplify.html" class="external-link">rmapshaper::ms_simplify()</a></code> function to do this.</p>
<p>First we get the data with <code><a href="../reference/get_map_data.html">get_map_data()</a></code> and provide
the <em>afstemningsomraader</em> (voting areas) as the type.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">voting</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_map_data.html">get_map_data</a></span><span class="op">(</span><span class="st">"afstemningsomraader"</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Getting data on `afstemningsomraader`. This usually takes 18.77s.</span></span>
<span><span class="co">#&gt; Fetching data from the API. This will take some time.</span></span>
<span><span class="co">#&gt; Reading data to `st`.</span></span>
<span><span class="co">#&gt; Converting map data to `sf` object</span></span></code></pre></div>
<p>Then let’s quickly examine how many more polygons we now have to
draw.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">municipalities</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">voting</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1315</span></span></code></pre></div>
<p>I have printed the amount of polygons for the municipality level as
well as the voting precinct level.</p>
<p>To plot all these polygons takes a substantial amount of time - You
can either just trust me on that or try it out for yourself after
finishing this article!</p>
<p>To accommodate this larger number of polygons we will simplify the
lines that make up said polygons.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">voting_simplified</span> <span class="op">&lt;-</span> <span class="fu">rmapshaper</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rmapshaper/man/ms_simplify.html" class="external-link">ms_simplify</a></span><span class="op">(</span></span>
<span>  <span class="va">voting</span>,</span>
<span>  keep <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  keep_shapes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After simplifying the data we can now plot it.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">voting_simplified</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">kommunenavn</span>, color <span class="op">=</span> <span class="va">navn</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_map.html" class="external-link">theme_map</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="printing_maps_files/figure-html/plot_voting-1.png" width="1152"></p>
<p>Here, I have colored the shapes based on the municipality and then
turned the lines of each shape to a different color based on the voting
precincts name.</p>
</div>
<div class="section level2">
<h2 id="overlaying-multiple-maps">Overlaying multiple maps<a class="anchor" aria-label="anchor" href="#overlaying-multiple-maps"></a>
</h2>
<p>If you would like to plot how different municipalities are
distributed in the police regions you can simply get the data for both
maps and pass them as their own dataset/geom combos in
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">police</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_map_data.html">get_map_data</a></span><span class="op">(</span><span class="st">"politikredse"</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Getting data on `politikredse`. This usually takes 14.14s.</span></span>
<span><span class="co">#&gt; Fetching data from the API. This will take some time.</span></span>
<span><span class="co">#&gt; Reading data to `st`.</span></span>
<span><span class="co">#&gt; Converting map data to `sf` object</span></span>
<span><span class="co"># We will reuse the municipality data from earlier.</span></span></code></pre></div>
<p>Then you can pass it to <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> as follows.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">police</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">navn</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">municipalities</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_map.html" class="external-link">theme_map</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="printing_maps_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<p>As you can see, we have now produced a map with shapes from different
subsections of Denmark.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://aleksanderbl.dk" class="external-link">Aleksander Bang-Larsen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
